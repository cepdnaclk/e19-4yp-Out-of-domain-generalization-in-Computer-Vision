<role>
    You are an {{ task_definition.role }} specializing in {{ task_definition.task_name }}.
</role>

<objective>
    We are refining discriminative visual descriptions for the concept: "{{ concept }}".
    Your goal is to generate {{ num_offsprings }} NEW description sets that are MORE discriminative than the current top performers.
</objective>

<context>
    The task involves {{ task_definition.class_names|length }} classes. 
    Any list of descriptions below STRICTLY follows this order:
    [{% for name in task_definition.class_names %}"{{ name }}"{% if not loop.last %}, {% endif %}{% endfor %}]
    
    EVALUATION METRICS EXPLAINED:
    - Overall Score: A score (0-100) representing the overall discriminative quality of the entire description set.
    - Per-Class Margin Scores: Individual margin scores for each class, ranging from -1.0 to 1.0.
      * High positive (>0.5): The description for this class is highly discriminative and confident.
      * Near zero (~0.0): The description struggles to differentiate this class from others.
      * Negative (<0.0): The description is actively confusing the model for this class.
    
    Use these per-class margins to identify which class descriptions need the most improvement.
</context>

<current_top_performers>
    Here are the current best description sets.
    Format: [List of descriptions matching class order], Overall Score: <normalized fitness 0-100>, Per-Class Margins: [Class 1 margin, Class 2 margin, ...]

    {% for parent in parents %}
    {{ parent.genotype.prompts | list }}, Overall Score: {{ parent.overall_score }}, Per-Class Margins: {{ parent.per_class_margins }}
    {% endfor %}
</current_top_performers>

<instruction>
    1. ANALYZE: Analyze at the <current_top_performers>. 
    2. STRATEGIZE: Devise a strategy to improve upon these description sets. Give special attention to classes with low or negative margin scores.
    3. GENERATE: Generate distinct {{ num_offsprings }} new description sets that are different from the <current_top_performers>. 
    
    Constraints:
    - Focus strictly on "{{ concept }}".
    - Maintain the EXACT class order defined in <context>.
    - Use precise medical terminology.
    - You SHOULD NOT reuse exact phrases from the current top performers.
    - You SHOULD NOT introduce new visual concepts. eg: if the concept is "Shape", do not describe "Color".
    - Give closer attention to differentiating the most similar classes. 
    - Output MUST be valid JSON, a list of lists.
    - Precede the JSON with a short "strategy" explaining your thought process.
</instruction>

<output_format>
# Strategy: ...

```json
[
    ["Description for {{ task_definition.class_names[0] }}", "Description for {{ task_definition.class_names[1] }}"{% if task_definition.class_names|length > 2 %}, "..."{% endif %}],
    ["...", "..."{% if task_definition.class_names|length > 2 %}, "..."{% endif %}]
]
```
</output_format>