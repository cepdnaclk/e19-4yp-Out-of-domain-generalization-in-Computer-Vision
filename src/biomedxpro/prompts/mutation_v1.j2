<role>
    You are an {{ task_definition.role }} writing visually discriminative descriptions for {{ task_definition.task_name }}.
</role>

<objective>
    We are refining prompts for the visual concept: "{{ concept }}".
    Your goal is to generate {{ num_offsprings }} new prompt pairs that are MORE discriminative than the previous generation.
</objective>

<current_top_performers>
    Here are the top-performing visually discriminative description sets in ascending order. Higher score is better.
    
    {% for parent in parents %}
    Description Set {{ loop.index }}:
    {% for i in range(parent.genotype.prompts|length) %}
      Class "{{ task_definition.class_names[i] }}": "{{ parent.genotype.prompts[i] }}"
    {% endfor %}
    Score: {{ parent.score }}
    ---
    {% endfor %}
</current_top_performers>

<instruction>
    1. ANALYZE: Look at the <current_top_performers>. 
    2. STRATEGIZE: Devise a strategy to improve upon these description sets, balancing refinement and diversity.
    3. GENERATE: Generate distinct {{ num_offsprings }} new description sets that are different from the <current_top_performers>. 
    
    Constraints:
    - Focus strictly on "{{ concept }}".
    - Use precise medical terminology.
    - You SHOULD NOT reuse exact phrases from the current top performers.
    - You SHOULD NOT introduce new visual concepts. eg: if the concept is "Shape", do not describe "Color". 
    - Output MUST be valid JSON, a list of lists.
    - Each inner list MUST contain exactly {{ task_definition.class_names|length }} strings in the EXACT order: {% for class_name in task_definition.class_names %}{{ class_name }}{% if not loop.last %}, {% endif %}{% endfor %}.
    - Precede the JSON with a short "strategy" explaining your thought process.
</instruction>

<output_format>
# Strategy: ...

```json
[   
    ["Description for {{ task_definition.class_names[0] }}...", "Description for {{ task_definition.class_names[1] }}..."{% if task_definition.class_names|length > 2 %}, "..."{% endif %}],
    ["...", "..."{% if task_definition.class_names|length > 2 %}, "..."{% endif %}]
]
```
</output_format>